<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>INTERACT | Multi‑Campaign Field Intelligence</title>
  <meta name="description" content="INTERACT multi-campaign field intelligence dashboard: sessions, media, maps, and analytics." />

  <meta property="og:title" content="INTERACT | Field Intelligence Dashboard" />
  <meta property="og:description" content="Multi-campaign dashboard with session analytics, media gallery, and interactive maps." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://interactsolutions.github.io/WheatCampaign/" />

  <link rel="preconnect" href="https://cdnjs.cloudflare.com" />
  <link rel="preconnect" href="https://unpkg.com" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />

  <link rel="stylesheet" href="style.css" />
  <link rel="icon" type="image/png" href="assets/Bayer.png" />
</head>

<body>
  <!-- Background (video optional, gracefully disabled on iOS / reduced-motion) -->
  <div class="bg">
    <video id="bgVideo" class="bg__video" autoplay muted loop playsinline>
      <source src="assets/gallery/bg.mp4" type="video/mp4" />
    </video>
    <div class="bg__overlay"></div>
  </div>

  <header class="topbar">
    <div class="topbar__safe">
      <div class="brand">
        <div class="brand__mark">INTERACT</div>
        <div class="brand__sub">Field Intelligence</div>
      </div>

      <div class="topbar__controls">
        <div class="control control--inline">
          <label class="control__label" for="campaignSelect">Campaign</label>
          <select id="campaignSelect" class="select"></select>
        </div>

        <button id="btnShare" class="btn btn--ghost" title="Copy share link">
          <i class="fa-solid fa-link"></i><span class="btn__text">Share</span>
        </button>

        <button id="btnExport" class="btn btn--primary" title="Export filtered sessions to CSV">
          <i class="fa-solid fa-download"></i><span class="btn__text">Export</span>
        </button>
      </div>
    </div>
  </header>

  <main class="shell">
    <section class="hero">
      <div class="hero__left">
        <h1 id="campaignTitle" class="hero__title">Loading…</h1>
        <div id="campaignMeta" class="hero__meta">Preparing dashboard</div>

        <div class="kpiGrid">
          <div class="kpi">
            <div class="kpi__label">Sessions</div>
            <div id="kpiSessions" class="kpi__value">–</div>
          </div>
          <div class="kpi">
            <div class="kpi__label">Farmers</div>
            <div id="kpiFarmers" class="kpi__value">–</div>
          </div>
          <div class="kpi">
            <div class="kpi__label">Acres</div>
            <div id="kpiAcres" class="kpi__value">–</div>
          </div>
          <div class="kpi">
            <div class="kpi__label">Key Influencers</div>
            <div id="kpiInfluencers" class="kpi__value">–</div>
          </div>
        </div>

        <div id="dataHealth" class="notice notice--ok" hidden>
          <i class="fa-solid fa-circle-check"></i>
          <div>
            <div class="notice__title">Data integrity: OK</div>
            <div class="notice__text" id="dataHealthText"></div>
          </div>
        </div>
      </div>

      <div class="hero__right">
        <div class="scoreLegend">
          <div class="scoreLegend__title">Session Score</div>
          <div class="scoreLegend__items">
            <div class="pill pill--good">High (≥ 85)</div>
            <div class="pill pill--mid">Medium (70–84)</div>
            <div class="pill pill--low">Low (&lt; 70)</div>
          </div>
          <div class="scoreLegend__formula">
            35% Definite Use + 25% Awareness + 15% Used Last Year + 25% Understanding
          </div>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="panel__head">
        <div class="panel__title"><i class="fa-solid fa-sliders"></i> Filters</div>
        <div class="panel__subtitle">Apply filters to sessions, map, media, and analytics</div>
      </div>

      <div class="filters">
        <div class="control">
          <label class="control__label" for="districtFilter">District</label>
          <select id="districtFilter" class="select">
            <option value="all">All districts</option>
          </select>
        </div>

        <div class="control">
          <label class="control__label" for="dateFrom">Date from</label>
          <input id="dateFrom" type="date" class="input" />
        </div>

        <div class="control">
          <label class="control__label" for="dateTo">Date to</label>
          <input id="dateTo" type="date" class="input" />
        </div>

        <div class="control control--wide">
          <label class="control__label" for="search">Search</label>
          <input id="search" type="search" class="input" placeholder="Location, facilitator, dealer, host…" />
        </div>

        <div class="control control--actions">
          <button id="btnApply" class="btn btn--primary"><i class="fa-solid fa-filter"></i> Apply</button>
          <button id="btnReset" class="btn btn--ghost"><i class="fa-solid fa-rotate-left"></i> Reset</button>
        </div>
      </div>
    </section>

    <section class="tabs">
      <button class="tab tab--active" data-tab="overview"><i class="fa-solid fa-chart-column"></i> Overview</button>
      <button class="tab" data-tab="map"><i class="fa-solid fa-map-location-dot"></i> Map</button>
      <button class="tab" data-tab="sessions"><i class="fa-solid fa-table"></i> Sessions</button>
      <button class="tab" data-tab="media"><i class="fa-solid fa-images"></i> Media</button>
    </section>

    <section id="tab-overview" class="panel tabPanel tabPanel--active">
      <div class="panel__head">
        <div class="panel__title"><i class="fa-solid fa-bullseye"></i> Decision Insights</div>
        <div class="panel__subtitle">Auto-generated from filtered sessions</div>
      </div>

      <div class="insights" id="insights"></div>
      <div class="miniGrid">
        <div class="miniCard">
          <div class="miniCard__title">Score Distribution</div>
          <canvas id="chartScore"></canvas>
        </div>
        <div class="miniCard">
          <div class="miniCard__title">Top Districts by Acres</div>
          <canvas id="chartDistrictAcres"></canvas>
        </div>
      </div>
    </section>

    <section id="tab-map" class="panel tabPanel">
      <div class="panel__head">
        <div class="panel__title"><i class="fa-solid fa-map"></i> Coverage Map</div>
        <div class="panel__subtitle">Markers are colored by Session Score</div>
      </div>
      <div class="mapWrap">
        <div id="map" class="map"></div>
        <div class="mapHint">
          Tip: tap a marker to view the mini session card and open the session detail.
        </div>
      </div>
    </section>

    <section id="tab-sessions" class="panel tabPanel">
      <div class="panel__head">
        <div class="panel__title"><i class="fa-solid fa-list-check"></i> Session Register</div>
        <div class="panel__subtitle">Desktop table + mobile cards, both sourced from the same data</div>
      </div>

      <div class="viewToggle">
        <button class="btn btn--ghost btn--sm viewBtn viewBtn--active" data-view="exec">Executive view</button>
        <button class="btn btn--ghost btn--sm viewBtn" data-view="field">Field view</button>
      </div>

      <div class="tableWrap">
        <table class="table" id="sessionsTable">
          <thead id="sessionsThead"></thead>
          <tbody id="sessionsTbody"></tbody>
        </table>
      </div>

      <div id="sessionsCards" class="cards"></div>
    </section>

    <section id="tab-media" class="panel tabPanel">
      <div class="panel__head">
        <div class="panel__title"><i class="fa-solid fa-photo-film"></i> Media Evidence</div>
        <div class="panel__subtitle">Grouped by session. Placeholders are flagged as “pending”.</div>
      </div>

      <div class="mediaBar">
        <div class="pill pill--neutral" id="mediaCount">0 items</div>
        <div class="pill pill--neutral" id="mediaMissing">0 pending</div>
      </div>

      <div id="mediaGrid" class="mediaGrid"></div>
    </section>

    <section class="panel footer">
      <div class="footer__left">
        <div class="footer__brand">INTERACT</div>
        <div class="footer__note">Multi‑campaign framework (add campaigns under <code>data/</code> and register in <code>data/campaigns.json</code>).</div>
      </div>
      <div class="footer__right">
        <a class="link" href="#" id="openSourceInfo">Data sources & scoring</a>
      </div>
    </section>
  </main>

  <!-- Session Detail Modal -->
  <div id="modal" class="modal" hidden>
    <div class="modal__backdrop" data-close></div>
    <div class="modal__panel" role="dialog" aria-modal="true">
      <div class="modal__head">
        <div class="modal__title" id="modalTitle">Session</div>
        <button class="btn btn--ghost btn--sm" data-close><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal__body" id="modalBody"></div>
    </div>
  </div>

  <!-- Lightbox -->
  <div id="lightbox" class="lightbox" hidden>
    <div class="lightbox__backdrop" data-close></div>
    <div class="lightbox__panel">
      <button class="btn btn--ghost btn--sm lightbox__close" data-close><i class="fa-solid fa-xmark"></i></button>
      <div id="lightboxBody" class="lightbox__body"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
