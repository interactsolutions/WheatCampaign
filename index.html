<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="theme-color" content="#0b1220"/>
  <title>Wheat Campaign • INTERACT</title>
  <link rel="stylesheet" href="./style.css"/>
  <link rel="icon" href="./assets/bayer.svg"/>
</head>
<body>
<div class="app">
  <header class="topbar">
    <div class="brand">
      <img class="brand__logo" src="./assets/bayer.svg" alt="Bayer"/>
      <div>
        <div class="brand__title">Wheat Campaign Dashboard</div>
        <div class="brand__subtitle">Campaign insights for brand management • INTERACT</div>
      </div>
    </div>

    <nav class="topbar__nav" aria-label="Primary">
      <button class="chip chip--active" data-tabbtn="summary" type="button">Summary</button>
      <button class="chip" data-tabbtn="map" type="button">Map</button>
      <button class="chip" data-tabbtn="sessions" type="button">Sessions</button>
      <button class="chip" data-tabbtn="media" type="button">Media</button>
      <button class="chip" data-tabbtn="feedback" type="button">Feedback</button>
      <a class="chip" href="./details.html">Detailed view</a>
      <a class="chip" href="./sheets.html">Sheets</a>
    </nav>
  </header>

  <main class="container">

    <section class="card" id="controlsCard">
      <div class="card__head">
        <h2>Filters</h2>
        <p class="muted">Filter by campaign, district and date range. Click any session row to open the session profile and full sheet.</p>
      </div>

      <div class="grid3">
        <div>
          <label class="label">Campaign</label>
          <select id="campaignSelect" class="input"></select>
        </div>
        <div>
          <label class="label">District</label>
          <select id="districtSelect" class="input"></select>
        </div>
        <div>
          <label class="label">Date range</label>
          <div class="dateRange">
            <input id="fromDate" type="date" class="input"/>
            <span class="to">to</span>
            <input id="toDate" type="date" class="input"/>
          </div>
        </div>
      </div>

      <div class="controlsRow">
        <div class="control" style="flex:1">
          <label>Search</label>
          <input id="q" class="input" placeholder="Host, dealer, village, competitor, notes…"/>
        </div>
        <div class="control actions">
          <label class="srOnly">Actions</label>
          <button class="btn primary" id="apply">Apply</button>
          <button class="btn" id="reset">Reset</button>
          <button class="btn" id="export">Export</button>
        </div>
      </div>

      <div class="kpis">
        <div class="kpi"><div class="kpi__k">Sessions</div><div class="kpi__v" id="kSessions">—</div></div>
        <div class="kpi"><div class="kpi__k">Farmers</div><div class="kpi__v" id="kFarmers">—</div></div>
        <div class="kpi"><div class="kpi__k">Acres</div><div class="kpi__v" id="kAcres">—</div></div>
        <div class="kpi"><div class="kpi__k">Avg Score</div><div class="kpi__v" id="kScore">—</div></div>
      </div>
    </section>

    <!-- SUMMARY TAB -->
    <section class="grid2" data-tab="summary" id="tab-summary">
      <section class="card" id="insights">
        <div class="card__head">
          <h2>Executive summary</h2>
          <p class="muted" id="execSummary">Loading…</p>
        </div>
        <div class="grid2">
          <div class="cardLite">
            <h3>Adoption intent</h3>
            <canvas id="chartIntent" height="210" aria-label="Adoption intent chart" role="img"></canvas>
            <div class="muted">Avg definite intent across selection.</div>
          </div>
          <div class="cardLite">
            <h3>Brand awareness</h3>
            <canvas id="chartAware" height="210" aria-label="Brand awareness chart" role="img"></canvas>
            <div class="muted">Average awareness in the filtered set.</div>
          </div>
        </div>

        <div class="divider"></div>
        <div class="grid3">
          <div class="stat"><div class="stat__k">Avg understanding</div><div class="stat__v" id="sUnderstanding">—</div></div>
          <div class="stat"><div class="stat__k">% used last year</div><div class="stat__v" id="sUsed">—</div></div>
          <div class="stat"><div class="stat__k">Top district (by acres)</div><div class="stat__v" id="sTopDistrict">—</div></div>
        </div>
      </section>

      <section class="card" id="nextSteps">
        <div class="card__head">
          <h2>Recommendations</h2>
          <p class="muted">Automated actions based on campaign outcomes. These are derived from the last sessions in the filtered set.</p>
        </div>
        <ul id="actionList" class="actionsList"></ul>
      </section>
    </section>

    <!-- MAP TAB -->
    <section class="card" data-tab="map" id="tab-map">
      <div class="card__head">
        <h2>Coverage map</h2>
        <p class="muted">All session markers are based on the filtered set. Click a marker to open the session profile.</p>
      </div>
      <div id="map" class="map"></div>
      <div class="muted" id="mapMeta" style="margin-top:10px">—</div>
    </section>

    <!-- SESSIONS TAB -->
    <section class="card" data-tab="sessions" id="tab-sessions">
      <div class="card__head">
        <h2>Sessions</h2>
        <p class="muted">Filter by district and date to view exact sessions and their outcomes. Tap a row to open the session profile.</p>
      </div>
      <div class="tableWrap">
        <table class="table" id="sessionsTable"></table>
      </div>
      <div class="pager" id="sessionsPager"></div>
    </section>

    <!-- MEDIA TAB -->
    <section class="card" data-tab="media" id="tab-media">
      <div class="card__head">
        <h2>Media wall</h2>
        <p class="muted">Media is derived from each session. Click an item to open full-screen and use the back button to return.</p>
      </div>
      <div class="mediaFilters" id="mediaFilters"></div>
      <div class="mediaGrid" id="mediaGrid"></div>
      <div class="muted" id="mediaMeta" style="margin-top:10px">—</div>
    </section>

    <!-- FEEDBACK TAB -->
    <section class="card" data-tab="feedback" id="tab-feedback">
      <div class="card__head">
        <h2>Feedback</h2>
        <p class="muted">Submit internal feedback (brand, field ops, quality). Stored locally for now (GitHub Pages).</p>
      </div>
      <form id="feedbackForm" class="form">
        <div class="grid2">
          <div>
            <label class="label">Your name</label>
            <input class="input" name="name" required/>
          </div>
          <div>
            <label class="label">Role / team</label>
            <input class="input" name="role"/>
          </div>
        </div>
        <div>
          <label class="label">Comments</label>
          <textarea class="input" name="comment" rows="4" required></textarea>
        </div>
        <div class="controlsRow">
          <div style="flex:1" class="muted">Note: this demo stores feedback in your browser only. For centralized collection, integrate a backend or Google Form.</div>
          <div class="actions">
            <button class="btn primary" type="submit">Submit</button>
            <button class="btn" type="button" id="clearFeedback">Clear local</button>
          </div>
        </div>
        <div class="divider"></div>
        <h3>Local feedback entries</h3>
        <div class="tableWrap"><table class="table" id="feedbackTable"></table></div>
      </form>
    </section>

  </main>
</div>

<!-- Session drawer -->
<div class="drawer hidden" id="sessionDrawer" aria-hidden="true">
  <div class="drawer__panel">
    <button class="drawer__close" id="closeDrawer" aria-label="Close">×</button>
    <div class="drawer__head">
      <h2 id="dTitle">Session</h2>
      <div class="muted" id="dSubtitle">—</div>
    </div>

    <div class="grid2">
      <div class="kvBox"><div class="kvBox__k">Host</div><div class="kvBox__v" id="dHost">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Sales rep</div><div class="kvBox__v" id="dSales">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Dealer</div><div class="kvBox__v" id="dDealer">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Farmers</div><div class="kvBox__v" id="dFarmers">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Wheat acres</div><div class="kvBox__v" id="dAcres">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Definite</div><div class="kvBox__v" id="dDefinite">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Score</div><div class="kvBox__v" id="dScore">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Top reason to use</div><div class="kvBox__v" id="dReasonUse">—</div></div>
      <div class="kvBox"><div class="kvBox__k">Top reason not to use</div><div class="kvBox__v" id="dReasonNot">—</div></div>
    </div>

    <div class="drawer__actions">
      <a class="btn" id="dMaps" target="_blank" rel="noopener">Open in Maps</a>
      <a class="btn" id="dSheet" target="_blank" rel="noopener">Open full sheet</a>
      <button class="btn primary" id="dShare" type="button">Share session</button>
    </div>

    <div class="divider"></div>
    <h3>Session media</h3>
    <div class="mediaGrid" id="sessionMedia"></div>
  </div>
</div>

<!-- Lightbox -->
<div class="lightbox hidden" id="lightbox" aria-hidden="true">
  <button class="lightbox__close" id="closeLightbox" aria-label="Back">← Back</button>
  <div class="lightbox__body" id="lightboxBody"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<script src="./dashboard.js"></script>
</body>
</html>
