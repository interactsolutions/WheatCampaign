<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgriVista Dashboard - Buctril Super Farmer Education Drive 2025</title>
    
    <!-- SEO and Social Meta Tags -->
    <meta name="description" content="Buctril Super Farmer Education Drive 2025 - Interactive dashboard with session analytics, media gallery, and interactive maps">
    <meta property="og:title" content="AgriVista Dashboard - Buctril Super Farmer Education Drive 2025">
    <meta property="og:description" content="Interactive dashboard tracking 40 sessions, 2,908 farmers, and 44,256 acres across 17 cities">
    <meta property="og:image" content="https://interactsolutions.github.io/WheatCampaign/assets/Buctril.jpg">
    <meta property="og:url" content="https://interactsolutions.github.io/WheatCampaign/">
    <meta name="twitter:card" content="summary_large_image">
    
    <!-- Preconnect for external resources -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://unpkg.com">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    
    <!-- Your CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Video Background -->
    <div class="video-background">
        <video autoplay muted loop playsinline>
            <source src="assets/bg.mp4" type="video/mp4">
        </video>
        <div class="video-fallback"></div>
    </div>

    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1><i class="fas fa-seedling"></i> AgriVista Dashboard</h1>
            <h2>Buctril Super Farmer Education Drive 2025</h2>
            
            <div class="header-subtitle">
                <div class="campaign-duration">
                    <i class="fas fa-calendar-alt"></i> 24 Nov - 12 Dec 2025
                </div>
                <div class="build-date">
                    <i class="fas fa-code"></i> Dashboard v2.5 Enhanced
                </div>
            </div>
            
            <div class="header-logos">
                <div class="logo-container">
                    <img src="assets/Bayer.png" alt="Bayer Logo" class="logo-img">
                </div>
                <div class="logo-container">
                    <img src="assets/Buctril.jpg" alt="Buctril Logo" class="logo-img">
                </div>
                <div class="logo-container">
                    <img src="assets/Interact.gif" alt="Interact Solutions Logo" class="logo-img">
                </div>
                <div class="logo-container">
                    <img src="assets/poductts.jpg" alt="Products" class="logo-img">
                </div>
            </div>
        </header>

        <!-- Error Banner -->
        <div id="errorBanner" class="error-banner" style="display: none;">
            <i class="fas fa-exclamation-triangle"></i>
            <div>
                <h3 id="errorMessage">Error loading data</h3>
                <div class="quick-checks">
                    <p>Quick checks:</p>
                    <ol>
                        <li>Check if sessions.json exists</li>
                        <li>Check if media.json exists</li>
                        <li>Verify your internet connection</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Dashboard Controls -->
        <div class="dashboard-controls">
            <div class="control-grid">
                <div class="control-group">
                    <label for="cityFilter"><i class="fas fa-city"></i> Filter by City</label>
                    <select id="cityFilter" class="dropdown">
                        <option value="all">All Cities</option>
                        <option value="sukkur">Sukkur</option>
                        <option value="dgk">Dera Ghazi Khan</option>
                        <option value="faisalabad">Faisalabad</option>
                        <option value="gujranwala">Gujranwala</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="searchInput"><i class="fas fa-search"></i> Search Sessions</label>
                    <input type="text" id="searchInput" class="search-input" placeholder="Search by location, facilitator...">
                </div>
                
                <div class="control-group">
                    <label><i class="fas fa-calendar"></i> Date Range</label>
                    <div class="date-group">
                        <input type="date" id="dateFrom" class="date-input" value="2025-11-24">
                        <span>to</span>
                        <input type="date" id="dateTo" class="date-input" value="2025-12-12">
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button id="applyFilters" class="btn btn-primary">
                    <i class="fas fa-filter"></i> Apply Filters
                </button>
                <button id="resetFilters" class="btn btn-outline">
                    <i class="fas fa-redo"></i> Reset All
                </button>
                <button id="exportData" class="btn btn-secondary">
                    <i class="fas fa-download"></i> Export CSV
                </button>
                <button id="refreshData" class="btn btn-outline">
                    <i class="fas fa-sync-alt"></i> Refresh
                </button>
                <!-- Share Summary button will be added dynamically -->
            </div>
        </div>

        <!-- Selection Summary -->
        <div class="selection-summary">
            <h3><i class="fas fa-chart-line"></i> Campaign Overview</h3>
            <div class="summary-stats">
                <div class="stat-item">
                    <div class="stat-value" id="sessionCount">0</div>
                    <div class="stat-label">Sessions</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="farmerCount">0</div>
                    <div class="stat-label">Farmers Reached</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="acreCount">0</div>
                    <div class="stat-label">Acres Covered</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="cityCount">0</div>
                    <div class="stat-label">Cities</div>
                </div>
                <div id="statusIndicator" class="status-indicator status-loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <span>Loading...</span>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="tab active" data-tab="overview">
                <i class="fas fa-home"></i> Overview
            </button>
            <button class="tab" data-tab="map">
                <i class="fas fa-map-marked-alt"></i> Interactive Map
            </button>
            <button class="tab" data-tab="gallery">
                <i class="fas fa-images"></i> Media Gallery
            </button>
            <button class="tab" data-tab="sessions">
                <i class="fas fa-table"></i> Session Details
            </button>
            <button class="tab" data-tab="analytics">
                <i class="fas fa-chart-bar"></i> Analytics
            </button>
        </div>

        <!-- Tab Content -->
        <div id="tabContent">
            <!-- Overview Tab -->
            <section id="overviewTab" style="display: block;">
                <div class="campaign-section">
                    <div class="campaign-header">
                        <h3 class="campaign-title">
                            <i class="fas fa-tractor"></i> Campaign Performance
                        </h3>
                        <div class="campaign-badge">
                            <i class="fas fa-bullseye"></i> 40 Sessions Completed
                        </div>
                    </div>
                    
                    <div class="overview-stats">
                        <div class="overview-card" title="Click to view all sessions">
                            <h3 id="totalSessions">40</h3>
                            <p>Total Sessions</p>
                            <small style="font-size: 12px; color: #666;">Click to view all</small>
                        </div>
                        <div class="overview-card" title="Click to filter Sukkur sessions">
                            <h3>16</h3>
                            <p>Sukkur Sessions</p>
                            <small style="font-size: 12px; color: #666;">616 farmers</small>
                        </div>
                        <div class="overview-card" title="Click to filter DGK sessions">
                            <h3>10</h3>
                            <p>DGK Sessions</p>
                            <small style="font-size: 12px; color: #666;">387 farmers</small>
                        </div>
                        <div class="overview-card" title="Click to filter Faisalabad sessions">
                            <h3>8</h3>
                            <p>Faisalabad Sessions</p>
                            <small style="font-size: 12px; color: #666;">313 farmers</small>
                        </div>
                    </div>
                </div>
                
                <!-- Key Takeaways -->
                <div class="key-takeaways">
                    <h2><i class="fas fa-lightbulb"></i> Key Takeaways</h2>
                    <p class="campaign-description">
                        Buctril Super Farmer Education Drive 2025 successfully conducted 40 sessions across 17 cities,
                        engaging 2,908 farmers and covering 44,256 acres. The campaign focused on product education,
                        application techniques, and safety measures.
                    </p>
                    
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-value">94%</div>
                            <p>Farmer Engagement</p>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">88%</div>
                            <p>Satisfaction Rate</p>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">92%</div>
                            <p>Recommendation Score</p>
                        </div>
                        <div class="metric-card">
                            <div class="metric-value">84%</div>
                            <p>Awareness Increase</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Map Tab -->
            <section id="mapTab" style="display: none;">
                <div class="map-container">
                    <div id="campaignMap"></div>
                    <div class="map-banner">
                        <span id="mapStats">
                            <i class="fas fa-map-marker-alt"></i>
                            Loading map data...
                        </span>
                    </div>
                </div>
                
                <div class="map-controls-grid">
                    <div class="map-controls-panel">
                        <h3><i class="fas fa-sliders-h"></i> Map Controls</h3>
                        <div class="control-section">
                            <label>Attendance Filter</label>
                            <input type="range" id="attendanceRange" class="range-slider" min="0" max="100" value="0">
                            <div class="range-labels">
                                <span>All</span>
                                <span id="rangeValue">All farmers</span>
                                <span>100+</span>
                            </div>
                        </div>
                        
                        <div class="control-section">
                            <label>Session Types</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" class="map-filter" value="education" checked>
                                    <i class="fas fa-graduation-cap" style="color: #2e7d32;"></i> Education
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="map-filter" value="demonstration" checked>
                                    <i class="fas fa-flask" style="color: #ff9800;"></i> Demonstration
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="map-filter" value="training" checked>
                                    <i class="fas fa-chalkboard-teacher" style="color: #2196f3;"></i> Training
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" class="map-filter" value="field" checked>
                                    <i class="fas fa-tractor" style="color: #9c27b0;"></i> Field
                                </label>
                            </div>
                        </div>
                        
                        <div class="button-group" style="margin-top: 20px;">
                            <button id="fitBounds" class="btn btn-primary">
                                <i class="fas fa-search-plus"></i> Fit to Sessions
                            </button>
                            <button id="resetMap" class="btn btn-outline">
                                <i class="fas fa-globe-asia"></i> Reset View
                            </button>
                        </div>
                    </div>
                    
                    <div class="map-controls-panel">
                        <h3><i class="fas fa-info-circle"></i> Map Statistics</h3>
                        <div id="mapFilterStats" class="distribution-value">0 sessions shown</div>
                        <div class="distribution-subtext">
                            Click on markers to view session details. Clusters show multiple sessions in nearby locations.
                        </div>
                    </div>
                </div>
            </section>

            <!-- Gallery Tab -->
            <section id="galleryTab" style="display: none;">
                <div class="gallery-section">
                    <div class="gallery-filters">
                        <button class="gallery-filter-btn active" data-filter="all">
                            <i class="fas fa-th"></i> All Photos
                        </button>
                        <button class="gallery-filter-btn" data-filter="sukkur">
                            <i class="fas fa-map-pin"></i> Sukkur
                        </button>
                        <button class="gallery-filter-btn" data-filter="dgk">
                            <i class="fas fa-map-pin"></i> Dera Ghazi Khan
                        </button>
                        <button class="gallery-filter-btn" data-filter="faisalabad">
                            <i class="fas fa-map-pin"></i> Faisalabad
                        </button>
                        <button class="gallery-filter-btn" data-filter="gujranwala">
                            <i class="fas fa-map-pin"></i> Gujranwala
                        </button>
                    </div>
                    
                    <div id="mediaGallery" class="gallery-grid">
                        <!-- Gallery items will be loaded here -->
                    </div>
                    
                    <div class="gallery-footer">
                        <p><i class="fas fa-info-circle"></i> Click on any image to view larger version. Images load progressively for better performance.</p>
                    </div>
                </div>
            </section>

            <!-- Sessions Tab -->
            <section id="sessionsTab" style="display: none;">
                <div class="sessions-table-container">
                    <table class="sessions-table">
                        <thead>
                            <tr>
                                <th>Session ID</th>
                                <th>Date</th>
                                <th>City</th>
                                <th>Location</th>
                                <th>Facilitator</th>
                                <th>Farmers</th>
                                <th>Acres</th>
                                <th>Focus Area</th>
                            </tr>
                        </thead>
                        <tbody id="sessionsTableBody">
                            <!-- Sessions will be loaded here -->
                        </tbody>
                    </table>
                </div>
                
                <div class="pagination-controls">
                    <div class="pagination-info">
                        Showing <span id="shownSessions">0</span> of <span id="totalSessionsCount">0</span> sessions
                    </div>
                    <div class="pagination-buttons">
                        <button id="prevPage" class="btn btn-outline" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <button id="nextPage" class="btn btn-outline" disabled>
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </section>

            <!-- Analytics Tab -->
            <section id="analyticsTab" style="display: none;">
                <div class="insights-container">
                    <h3><i class="fas fa-chart-line"></i> Performance Analytics</h3>
                    
                    <div class="analytics-grid">
                        <div class="analytics-card">
                            <h3><i class="fas fa-users"></i> Daily Attendance</h3>
                            <div id="attendanceChart" class="chart-container">
                                <!-- Chart will be generated here -->
                            </div>
                            <div class="chart-note">
                                <i class="fas fa-info-circle"></i> Shows farmer attendance per session date. Click bars to filter by date.
                            </div>
                        </div>
                        
                        <div class="analytics-card">
                            <h3><i class="fas fa-chart-pie"></i> City Distribution</h3>
                            <div class="distribution-center">
                                <div class="distribution-value" id="cityDistribution">4</div>
                                <div class="distribution-label">Cities Covered</div>
                                <div class="distribution-subtext">
                                    Sessions distributed across major agricultural regions
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Performance Metrics -->
                <div class="performance-section">
                    <h3><i class="fas fa-tachometer-alt"></i> Performance Metrics</h3>
                    <div class="performance-grid">
                        <div class="performance-card">
                            <div class="performance-value">90%</div>
                            <div class="performance-label">Definite Intent</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value">77%</div>
                            <div class="performance-label">Brand Loyalty</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value">85%</div>
                            <div class="performance-label">Retention</div>
                        </div>
                        <div class="performance-card">
                            <div class="performance-value">89%</div>
                            <div class="performance-label">Adoption</div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <p>AgriVista Dashboard v2.5 Enhanced • Buctril Super Farmer Education Drive 2025</p>
            <p class="footer-subtext">
                <i class="fas fa-sync-alt"></i> Data updated: <span id="dataUpdated">22 Dec 2025</span>
                <span style="margin: 0 10px;">•</span>
                <i class="fas fa-bolt"></i> Performance Optimized
            </p>
            <div class="footer-links">
                <a href="#" id="helpSupport"><i class="fas fa-question-circle"></i> Help & Support</a>
                <a href="#" id="exportInsights"><i class="fas fa-download"></i> Export Insights</a>
                <a href="#" onclick="window.print()"><i class="fas fa-print"></i> Print Report</a>
                <!-- Feedback and Share buttons will be added dynamically -->
            </div>
        </footer>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="loader"></div>
        <p>Loading enhanced dashboard...</p>
        <p style="font-size: 14px; color: #666; margin-top: 10px;">Optimizing performance...</p>
    </div>

    <!-- Session Detail Modal -->
    <div id="sessionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalSessionTitle">Session Details</h3>
                <button class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="modal-grid">
                    <div class="modal-section">
                        <h4><i class="fas fa-info-circle"></i> Basic Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <span class="info-label">Session ID:</span>
                                <span id="modalSessionId" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Date:</span>
                                <span id="modalSessionDate" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">City:</span>
                                <span id="modalSessionCity" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Location:</span>
                                <span id="modalSessionLocation" class="info-value"></span>
                            </div>
                            <div class="info-item">
                                <span class="info-label">Facilitator:</span>
                                <span id="modalSessionFacilitator" class="info-value"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <h4><i class="fas fa-chart-bar"></i> Statistics</h4>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-users"></i></div>
                                <div class="stat-content">
                                    <div class="stat-number" id="modalSessionFarmers">0</div>
                                    <div class="stat-label">Farmers</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-seedling"></i></div>
                                <div class="stat-content">
                                    <div class="stat-number" id="modalSessionAcres">0</div>
                                    <div class="stat-label">Acres</div>
                                </div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-icon"><i class="fas fa-bullseye"></i></div>
                                <div class="stat-content">
                                    <div class="stat-number" id="modalSessionFocus"></div>
                                    <div class="stat-label">Focus Area</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <h4><i class="fas fa-map-marker-alt"></i> Location Map</h4>
                        <div id="modalMap" style="height: 200px; border-radius: 8px; background: #f5f5f5; display: flex; align-items: center; justify-content: center; color: #666;">
                            <i class="fas fa-map-marked-alt" style="font-size: 48px; opacity: 0.3;"></i>
                        </div>
                    </div>
                    
                    <div class="modal-section">
                        <h4><i class="fas fa-images"></i> Session Media</h4>
                        <div id="modalMediaGallery" class="modal-gallery">
                            <!-- Media will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="modalCloseBtn">Close</button>
                <button class="btn btn-primary" id="modalShareBtn">
                    <i class="fas fa-share-alt"></i> Share Session
                </button>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedbackModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3><i class="fas fa-comment-alt"></i> Share Your Feedback</h3>
                <button class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="feedbackForm">
                    <div class="form-group">
                        <label for="feedbackName"><i class="fas fa-user"></i> Your Name</label>
                        <input type="text" id="feedbackName" class="form-control" placeholder="Enter your name" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackPhone"><i class="fas fa-phone"></i> Phone Number</label>
                        <input type="tel" id="feedbackPhone" class="form-control" placeholder="+92 300 1234567">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackEmail"><i class="fas fa-envelope"></i> Email Address</label>
                        <input type="email" id="feedbackEmail" class="form-control" placeholder="you@example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackType"><i class="fas fa-tag"></i> Feedback Type</label>
                        <select id="feedbackType" class="form-control">
                            <option value="general">General Feedback</option>
                            <option value="suggestion">Suggestion</option>
                            <option value="bug">Bug Report</option>
                            <option value="feature">Feature Request</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackMessage"><i class="fas fa-comment"></i> Your Message</label>
                        <textarea id="feedbackMessage" class="form-control" rows="4" placeholder="Share your thoughts, suggestions, or feedback..." required></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="feedbackContactMethod">Preferred Contact Method</label>
                        <div class="contact-methods">
                            <label class="checkbox-label">
                                <input type="checkbox" name="contactMethod" value="whatsapp">
                                <i class="fab fa-whatsapp" style="color: #25D366;"></i> WhatsApp
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="contactMethod" value="email">
                                <i class="fas fa-envelope" style="color: #EA4335;"></i> Email
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="contactMethod" value="phone">
                                <i class="fas fa-phone" style="color: #34A853;"></i> Phone Call
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="feedbackCancel">Cancel</button>
                <button class="btn btn-primary" id="feedbackSubmit">
                    <i class="fas fa-paper-plane"></i> Submit Feedback
                </button>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3><i class="fas fa-share-alt"></i> Share This Dashboard</h3>
                <button class="modal-close" aria-label="Close modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="share-options">
                    <button class="share-option" data-platform="whatsapp">
                        <i class="fab fa-whatsapp"></i>
                        <span>WhatsApp</span>
                    </button>
                    <button class="share-option" data-platform="facebook">
                        <i class="fab fa-facebook"></i>
                        <span>Facebook</span>
                    </button>
                    <button class="share-option" data-platform="twitter">
                        <i class="fab fa-twitter"></i>
                        <span>Twitter</span>
                    </button>
                    <button class="share-option" data-platform="linkedin">
                        <i class="fab fa-linkedin"></i>
                        <span>LinkedIn</span>
                    </button>
                    <button class="share-option" data-platform="email">
                        <i class="fas fa-envelope"></i>
                        <span>Email</span>
                    </button>
                    <button class="share-option" data-platform="copy">
                        <i class="fas fa-copy"></i>
                        <span>Copy Link</span>
                    </button>
                </div>
                <div class="share-url">
                    <input type="text" id="shareUrl" readonly value="https://interactsolutions.github.io/WheatCampaign/">
                    <button class="btn-copy" id="copyUrlBtn">
                        <i class="fas fa-copy"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notification Container -->
    <div id="toastContainer"></div>

    <!-- JavaScript Libraries -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    
    <!-- Main Dashboard JavaScript -->
    <script src="dashboard.js"></script>
    
    <!-- Modal event handlers -->
    <script>
        // Modal close handlers
        document.querySelectorAll('.modal-close, .btn-outline[id$="Cancel"], #modalCloseBtn').forEach(btn => {
            btn.addEventListener('click', function() {
                const modal = this.closest('.modal');
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        });
        
        // Close modal when clicking outside
        document.querySelectorAll('.modal').forEach(modal => {
            modal.addEventListener('click', function(e) {
                if (e.target === this) {
                    this.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            });
        });
        
        // Close modal with ESC key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                });
            }
        });
        
        // Form submission handler
        document.getElementById('feedbackForm')?.addEventListener('submit', function(e) {
            e.preventDefault();
            // Form submission handled in dashboard.js
        });
        
        // Share URL copy handler
        document.getElementById('copyUrlBtn')?.addEventListener('click', function() {
            const urlInput = document.getElementById('shareUrl');
            urlInput.select();
            urlInput.setSelectionRange(0, 99999);
            
            try {
                navigator.clipboard.writeText(urlInput.value);
                // Toast notification handled in dashboard.js
            } catch (err) {
                // Fallback
                document.execCommand('copy');
            }
        });
        
        // Share platform button handlers
        document.querySelectorAll('.share-option').forEach(button => {
            button.addEventListener('click', function() {
                const platform = this.dataset.platform;
                if (platform === 'copy') {
                    document.getElementById('copyUrlBtn').click();
                }
                // Platform-specific sharing handled in dashboard.js
            });
        });
    </script>
</body>
</html>
