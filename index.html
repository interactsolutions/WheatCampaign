<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#0b1220"/>
  <meta name="description" content="Executive-ready dashboard for Buctril Super wheat farmer education sessions: intent, awareness, understanding, coverage, media and map." />
  <meta property="og:title" content="Buctril Super ‚Ä¢ Campaign Dashboard" />
  <meta property="og:description" content="Campaign outcomes, farmer mood signals, session media and coverage map." />
  <meta property="og:type" content="website" />
  <title>INTERACT ‚Ä¢ Campaign Dashboard</title>
  <link rel="stylesheet" href="style.css"/>
  <!-- Leaflet (map) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>
<body>
  <div class="bg">
    <video id="bgVideo" class="bgVideo" autoplay muted loop playsinline preload="metadata"></video>
    <div class="bgShade"></div>
  </div>

  <header class="header">
    <div class="headerInner">
      <div class="brand">
        <div class="brandMark">INTERACT</div>
        <div class="brandSub">Insights, coverage and field media ‚Äî built for teams, partners and the community.</div>
      </div>
      <div class="headerActions">
        <a class="chip link" href="./details.html?campaign=buctril-super-2025">Detailed view</a>
        <a class="chip link" href="#feedback">Send feedback</a>
      </div>
    </div>

    <div class="heroWrap">
      <div class="heroPlayer" id="heroPlayer" aria-label="Header video playlist">
        <video id="heroVideo" muted autoplay playsinline loop preload="metadata"></video>
        <img id="heroPoster" alt="" />
        <div class="heroOverlay"></div>
        <div class="heroCaption">
          <div class="heroTitle" id="heroTitle">Campaign highlights</div>
          <div class="heroSub" id="heroSub">If video does not auto-play on iPhone, tap once to start.</div>
        </div>
        <div class="heroControls">
          <button class="iconBtn" id="heroPrev" title="Previous">‚Äπ</button>
          <button class="iconBtn" id="heroNext" title="Next">‚Ä∫</button>
          <button class="iconBtn" id="heroMute" title="Mute/Unmute">üîá</button>
        </div>
      </div>
      <div class="heroThumbs" id="heroThumbs" aria-label="Header video thumbnails"></div>
    </div>
  </header>

  <main class="main">
    <section class="controls card">
      <div class="controlsRow">
        <div class="control">
          <label>Campaign</label>
          <select id="campaignSelect"></select>
        </div>
        <div class="control">
          <label>District</label>
          <select id="districtSelect"></select>
        </div>
        <div class="control">
          <label>Search</label>
          <input id="searchInput" placeholder="Host, dealer, village, spot‚Ä¶"/>
        </div>
        <div class="control">
          <label>Date range</label>
          <div class="dateRange">
            <input id="fromDate" type="date"/>
            <span class="to">to</span>
            <input id="toDate" type="date"/>
          </div>
        </div>
        <div class="control actions">
          <label class="srOnly">Actions</label>
          <button class="btn primary" id="applyBtn">Apply</button>
          <button class="btn" id="resetBtn">Reset</button>
          <button class="btn" id="exportBtn">Export</button>
        </div>
      </div>

      <div class="statusRow">
        <div class="chips">
          <span class="chip" id="selectionChip">All districts ‚Ä¢ All dates</span>
          <span class="chip muted" id="statusChip">Status: initializing‚Ä¶</span>
          <div id="fatalHint" class="fatalHint" style="display:none"></div>
        </div>
        <div class="miniKPIs">
          <div class="miniKpi"><div class="miniLabel">Sessions</div><div class="miniVal" id="kSessions">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Farmers</div><div class="miniVal" id="kFarmers">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Acres</div><div class="miniVal" id="kAcres">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Avg Score</div><div class="miniVal" id="kScore">‚Äî</div></div>
        </div>
      </div>
    </section>

      <div class="tabs" role="tablist" aria-label="Dashboard sections">
        <a class="tabBtn tabBtn--active" data-tab="overview" role="tab" aria-selected="true" href="#overview">Overview</a>
        <a class="tabBtn" data-tab="metrics" role="tab" aria-selected="false" href="#metrics">Metrics &amp; Results</a>
        <a class="tabBtn" data-tab="mediaMap" role="tab" aria-selected="false" href="#media-map">Media &amp; Map</a>
        <a class="tabBtn" data-tab="feedback" role="tab" aria-selected="false" href="#feedback">Feedback &amp; Next Steps</a>
      </div>

    <section class="tabSection" data-tab="overview" id="overview">
      <section class="card span2">
        <h2 id="campaignH1" class="h1Title">Buctril Super ‚Ä¢ Wheat Activations</h2>
        <p class="muted" id="execSummary">
          This dashboard summarizes farmer education sessions for Buctril Super in wheat, showing adoption intent, awareness, understanding, and coverage.
          Use it to evaluate message uptake, field execution quality, and implications for brand ROI.
        </p>
        <div class="execKpiRow">
          <div class="miniKpi"><div class="miniLabel">Sessions</div><div class="miniVal" id="kSessions">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Farmers</div><div class="miniVal" id="kFarmers">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Acres</div><div class="miniVal" id="kAcres">‚Äî</div></div>
          <div class="miniKpi"><div class="miniLabel">Avg Score</div><div class="miniVal" id="kScore">‚Äî</div></div>
        </div>

        <div class="execHighlights">
          <div class="pill"><span class="pillKey">Headline</span> <span class="pillVal" id="headlineMetric">‚Äî</span></div>
          <div class="pill"><span class="pillKey">ROI signal</span> <span class="pillVal" id="roiSignal">‚Äî</span></div>
          <div class="pill"><span class="pillKey">Key risk</span> <span class="pillVal" id="keyRisk">‚Äî</span></div>
        </div>
      </section>

      <section class="card">
        <h3>Objective</h3>
        <p class="muted">
          Educate wheat farmers on Buctril Super‚Äôs role in weed control and yield protection, improve correct-use understanding (dose, water, timing),
          and drive intention to adopt across meaningful acres.
        </p>
        <h3>Storyline</h3>
        <ol class="storyList">
          <li><strong>Activities:</strong> field sessions, supervisor/backchecker observation, and farmer Q&amp;A.</li>
          <li><strong>Outcomes:</strong> awareness and understanding uplift, plus adoption intent and committed acres.</li>
          <li><strong>Next steps:</strong> targeted reinforcement where intent or clarity lags, with dealer enablement where availability/price objections appear.</li>
        </ol>
      </section>

      <section class="card">
        <h3>Quick recommendations</h3>
        <div class="recList" id="recList">
          <div class="recItem">Recommendations will populate after data loads.</div>
        </div>
      </section>
    </section>

    <section class="tabSection hidden" data-tab="metrics" id="metrics">
      <section class="grid2">
        <section class="card">
          <h2>Key metrics</h2>
          <p class="muted">Snapshot of intent, awareness, understanding and coverage for the current filter selection.</p>
          <div class="donutGrid">
            <div class="donutCard">
              <div class="donutTitle">Adoption intent</div>
              <div class="donutWrap" id="donutIntent"></div>
              <div class="donutMeta muted" id="metaIntent">‚Äî</div>
            </div>
            <div class="donutCard">
              <div class="donutTitle">Brand awareness</div>
              <div class="donutWrap" id="donutAwareness"></div>
              <div class="donutMeta muted" id="metaAwareness">‚Äî</div>
            </div>
            <div class="donutCard">
              <div class="donutTitle">Understanding</div>
              <div class="donutWrap" id="donutUnderstanding"></div>
              <div class="donutMeta muted" id="metaUnderstanding">‚Äî</div>
            </div>
            <div class="donutCard">
              <div class="donutTitle">Coverage</div>
              <div class="donutWrap" id="donutCoverage"></div>
              <div class="donutMeta muted" id="metaCoverage">‚Äî</div>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>Trends &amp; comparisons</h2>
          <p class="muted">Visuals for executive review: momentum over time and district-level comparisons.</p>
          <div class="chartBlock">
            <div class="chartTitle">Sessions over time</div>
            <canvas id="chartTrend" height="120"></canvas>
          </div>
          <div class="chartBlock">
            <div class="chartTitle">District comparison (Awareness vs Understanding)</div>
            <canvas id="chartDistrict" height="140"></canvas>
          </div>
          <div class="muted tiny">Tip: Use District filter to focus; charts update with filters.</div>
        </section>

        <section class="card span2">
          <h2>Sessions list</h2>
          <p class="muted">Click a session row to open the complete session sheet (comments + signatures + farmer roster).</p>
          <div class="tableWrap">
            <table class="tbl">
              <thead>
                <tr>
                  <th>Date</th><th>District</th><th>Spot</th><th>Farmers</th><th>Acres</th><th>Awareness</th><th>Definite</th><th>Score</th>
                </tr>
              </thead>
              <tbody id="sessionsTbody">
                <tr><td colspan="8" class="muted">Loading‚Ä¶</td></tr>
              </tbody>
            </table>
          </div>
        </section>
      </section>
    </section>

    <section class="tabSection hidden" data-tab="mediaMap" id="media-map">
      <section class="grid2">
        <section class="card mapCard">
          <div class="cardHead">
            <div>
              <h2>Map</h2>
              <p class="muted">Coverage by location. Click a spot for quick profile, then open the full sheet.</p>
            </div>
            <div class="cardActions">
              <button class="btn btnGhost" id="mapResetBtn" type="button">Reset</button>
            </div>
          </div>
          <div class="mapWrap">
            <div id="map" class="map"></div>
            <div class="mapFallback hidden" id="mapFallback">
              <div class="fallbackBox">
                <div class="fallbackTitle">Map unavailable</div>
                <div class="muted">If network blocks tiles, use the Sessions list for district-level insights.</div>
              </div>
            </div>
          </div>
        </section>

        <section class="card">
          <h2>Media wall</h2>
          <div class="mediaControls">
            <select class="sel" id="mediaType">
              <option value="all">All media</option>
              <option value="images">Images</option>
              <option value="videos">Videos</option>
            </select>
            <input class="in" id="mediaSearch" placeholder="Filter by district/spot keywords"/>
          </div>
          <div class="mediaWall" id="mediaWall">
            <div class="muted">Media loads on demand. Select a card to view fullscreen.</div>
          </div>
        </section>
      </section>
    </section>

    <section class="tabSection hidden" data-tab="feedback" id="feedback">
      <section class="grid2">
        <section class="card">
          <h2>Feedback</h2>
          <p class="muted">Share issues, observations, or improvement suggestions for the brand team and field execution.</p>
          <textarea class="ta" id="feedbackText" rows="8" placeholder="Write feedback here‚Ä¶"></textarea>
          <div class="btnRow">
            <button class="btn" id="waFeedbackBtn" type="button">Send on WhatsApp</button>
            <button class="btn btnGhost" id="emailFeedbackBtn" type="button">Send Email</button>
          </div>
          <div class="muted tiny">Tip: include session IDs (e.g., D1S1) and district names for fast action.</div>
        </section>

        <section class="card">
          <h2>Next steps</h2>
          <div class="nextSteps" id="nextSteps">
            <div class="step">‚Ä¢ Reinforce key messages where understanding is below target.</div>
            <div class="step">‚Ä¢ Prepare objection-handling where ‚ÄúPrice too high‚Äù or ‚Äúgeneric preference‚Äù appears.</div>
            <div class="step">‚Ä¢ Coordinate dealer availability and recommendation programs in low-availability districts.</div>
          </div>
          <div class="btnRow">
            <a class="btn btnGhost" href="./details.html" id="detailsLink">Open Detailed View</a>
            <button class="btn btnGhost" id="btnPresentation" type="button">Presentation Mode</button>
          </div>
        </section>
      </section>
    </section>

<footer class="footer">
      <div class="footerBrands" id="footerBrands" aria-label="Brand assets"></div>
      <div class="muted">Powered by <strong>INTERACT</strong> ‚Äî multi-campaign field intelligence dashboards.</div>
    </footer>

  </main>

  <div class="lightbox hidden" id="lightbox" aria-hidden="true">
    <div class="lightboxInner">
      <button class="iconBtn lightboxClose" id="lightboxClose" title="Close">‚úï</button>
      <div class="lightboxBody" id="lightboxBody"></div>
      <div class="lightboxActions">
        <button class="btn" id="shareMediaBtn">Share</button>
        <button class="btn" id="copyLinkBtn">Copy link</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>
  <script src="dashboard.js?v=20251230" defer></script>
<script>
/* Tab fallback: keeps navigation working even if dashboard.js fails to load */
(function(){
  function $$ (sel, root){ return (root||document).querySelector(sel); }
  function $$$ (sel, root){ return Array.prototype.slice.call((root||document).querySelectorAll(sel)); }
  function setActive(tab){
    tab = (tab||'overview').replace(/^#/, '');
    if(tab==='media-map') tab='mediaMap';

    var btns = $$$('.tabBtn[data-tab]');
    var secs = $$$('section[data-tab]');
    btns.forEach(function(b){
      var on = (b.getAttribute('data-tab')===tab);
      b.classList.toggle('tabBtn--active', on);
      b.setAttribute('aria-selected', on ? 'true' : 'false');
    });
    secs.forEach(function(s){
      var on = (s.getAttribute('data-tab')===tab);
      s.classList.toggle('hidden', !on);
    });
  }
  document.addEventListener('click', function(e){
    var a = e.target && e.target.closest ? e.target.closest('.tabBtn[data-tab]') : null;
    if(!a) return;
    // allow hash update, but ensure UI updates immediately
    var tab = a.getAttribute('data-tab');
    setActive(tab);
  }, true);

  window.addEventListener('hashchange', function(){
    setActive((location.hash||'#summary').slice(1));
  });

  document.addEventListener('DOMContentLoaded', function(){
    // initialize from hash
    setActive((location.hash||'#summary').slice(1));
  });
})();
</script>
</body>
</html>
